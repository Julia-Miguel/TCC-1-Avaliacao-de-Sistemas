{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Nova%20pasta/TCC-1-Avaliacao-de-Sistemas/frontend/src/services/api.ts"],"sourcesContent":["// frontend/src/services/api.ts\r\nimport axios from \"axios\";\r\n\r\nconst api = axios.create({\r\n  baseURL: \"http://localhost:4444\",\r\n});\r\n\r\n// --- NOVO: Interceptor para adicionar o token JWT ---\r\napi.interceptors.request.use(\r\n  async (config) => {\r\n    // Verifica se estamos no ambiente do navegador antes de tentar acessar o localStorage\r\n    if (typeof window !== \"undefined\") {\r\n      const token = localStorage.getItem('adminToken');\r\n      if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n      }\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(new Error(error?.message ?? String(error)));\r\n  }\r\n);\r\n// --------------------------------------------------\r\n\r\nexport default api;"],"names":[],"mappings":"AAAA,+BAA+B;;;;AAC/B;;AAEA,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IACvB,SAAS;AACX;AAEA,uDAAuD;AACvD,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,OAAO;IACL,sFAAsF;IACtF,uCAAmC;;IAKnC;IACA,OAAO;AACT,GACA,CAAC;IACC,OAAO,QAAQ,MAAM,CAAC,IAAI,MAAM,OAAO,WAAW,OAAO;AAC3D;uCAIa"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Nova%20pasta/TCC-1-Avaliacao-de-Sistemas/frontend/src/app/%28auth-empresa%29/admin/login/page.tsx"],"sourcesContent":["// frontend/src/app/(auth-empresa)/admin/login/page.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect, Suspense } from 'react';\r\nimport api from '@/services/api'; //\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport '../../../globals.css'; \r\n// import ApplicationLogo from '@/components/ApplicationLogo'; // Descomente se for usar o logo aqui\r\nimport { useAuth } from '@/contexts/AuthContext'; // Importar useAuth\r\n\r\ninterface AdminLogado {\r\n  id: number;\r\n  nome: string;\r\n  email: string;\r\n  tipo: 'ADMIN_EMPRESA'; \r\n  empresaId: number;\r\n}\r\n\r\nfunction LoginForm() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const { loginAdmin } = useAuth(); // Obter a função loginAdmin do contexto\r\n\r\n  const [email, setEmail] = useState('');\r\n  const [senha, setSenha] = useState('');\r\n  const [empresaId, setEmpresaId] = useState<string | null>(null); \r\n  const [empresaNome, setEmpresaNome] = useState<string | null>(null);\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false); \r\n  const [isPageLoading, setIsPageLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const idDaEmpresa = searchParams.get('empresaId');\r\n    const nomeDaEmpresa = searchParams.get('empresaNome'); \r\n\r\n    if (idDaEmpresa) {\r\n      setEmpresaId(idDaEmpresa);\r\n      if (nomeDaEmpresa) {\r\n        setEmpresaNome(decodeURIComponent(nomeDaEmpresa)); \r\n      }\r\n    } else {\r\n      setError(\"ID da empresa não fornecido. Você será redirecionado.\");\r\n      setTimeout(() => {\r\n        router.push('/empresas/login');\r\n      }, 3000);\r\n    }\r\n    setIsPageLoading(false); \r\n  }, [searchParams, router]);\r\n\r\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    setError('');\r\n\r\n    if (!empresaId) {\r\n      setError(\"ID da empresa não identificado. Não é possível fazer login.\");\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await api.post<{ admin: AdminLogado, token: string }>('/usuarios/login-admin', { //\r\n        email,\r\n        senha,\r\n        empresaId: parseInt(empresaId),\r\n      });\r\n\r\n      const { admin, token } = response.data;\r\n      \r\n      loginAdmin(admin, token); // Usar a função do AuthContext\r\n      // O redirecionamento agora é tratado dentro do loginAdmin\r\n\r\n    } catch (err: any) {\r\n      console.error('Erro ao fazer login do admin:', err);\r\n      if (err.response?.data?.message) {\r\n        setError(err.response.data.message);\r\n      } else if (err.request) {\r\n        setError('Não foi possível conectar ao servidor. Verifique sua conexão.');\r\n      }\r\n      else {\r\n        setError('Ocorreu um erro desconhecido ao tentar fazer login.');\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (isPageLoading) { \r\n      return (\r\n        <div className=\"flex justify-center items-center min-h-[200px]\">\r\n            <p className=\"text-text-muted\">Verificando informações da empresa...</p>\r\n        </div>\r\n      );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* <div className=\"flex justify-center mb-4\"> */}\r\n      {/* <ApplicationLogo className=\"w-12 h-12 text-primary\" /> */}\r\n      {/* </div> */}\r\n      <h3 className=\"text-center text-xl sm:text-2xl font-semibold text-text-base mb-2\">\r\n        Login do Administrador\r\n      </h3>\r\n      {empresaNome && (\r\n        <p className=\"text-center text-sm text-text-muted mb-6\">\r\n          Empresa: <span className=\"font-medium text-text-base\">{empresaNome}</span> (ID: {empresaId})\r\n        </p>\r\n      )}\r\n      {!empresaNome && empresaId && (\r\n          <p className=\"text-center text-sm text-text-muted mb-6\">Para Empresa ID: {empresaId}</p>\r\n      )}\r\n      \r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        {error && (\r\n          <p className=\"text-sm text-center text-error bg-red-50 dark:bg-red-700/10 p-3 rounded-md border border-error\">\r\n            {error}\r\n          </p>\r\n        )}\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"admin-email\" className=\"form-label\">Email do Administrador</label>\r\n          <input\r\n            id=\"admin-email\"\r\n            type=\"email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n            className=\"input-edit-mode\"\r\n            placeholder=\"seu.email@empresa.com\"\r\n            disabled={!empresaId || isLoading}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"admin-senha\" className=\"form-label\">Senha</label>\r\n          <input\r\n            id=\"admin-senha\"\r\n            type=\"password\"\r\n            value={senha}\r\n            onChange={(e) => setSenha(e.target.value)}\r\n            required\r\n            className=\"input-edit-mode\"\r\n            placeholder=\"Sua senha de administrador\"\r\n            disabled={!empresaId || isLoading}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"pt-2 space-y-3\">\r\n          <button \r\n            type=\"submit\" \r\n            className=\"btn btn-primary w-full py-2.5 text-sm\" \r\n            disabled={isLoading || !empresaId}\r\n          >\r\n            {isLoading ? \"Entrando...\" : \"Entrar como Admin\"}\r\n          </button>\r\n          <Link \r\n            href=\"/empresas/login\" \r\n            className=\"btn btn-link w-full text-sm text-center block\" // btn-link para um estilo de link simples\r\n            aria-disabled={isLoading}\r\n            style={isLoading ? { pointerEvents: 'none', opacity: 0.7 } : {}}\r\n          >\r\n            Identificação da empresa incorreta? Voltar\r\n          </Link>\r\n        </div>\r\n      </form>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default function Page() {\r\n  return (\r\n    <Suspense fallback={\r\n        <div className=\"flex justify-center items-center min-h-[200px]\">\r\n            <p className=\"text-text-muted\">Carregando...</p>\r\n        </div>\r\n    }>\r\n      <LoginForm />\r\n    </Suspense>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}