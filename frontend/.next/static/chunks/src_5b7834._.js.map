{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/andre/OneDrive/%C3%81rea%20de%20Trabalho/Nova%20pasta/TCC-1-Avaliacao-de-Sistemas/frontend/src/services/api.ts"],"sourcesContent":["// frontend/src/services/api.ts\r\nimport axios from \"axios\";\r\n\r\nconst api = axios.create({\r\n  baseURL: \"http://localhost:4444\",\r\n});\r\n\r\n// --- NOVO: Interceptor para adicionar o token JWT ---\r\napi.interceptors.request.use(\r\n  async (config) => {\r\n    // Verifica se estamos no ambiente do navegador antes de tentar acessar o localStorage\r\n    if (typeof window !== \"undefined\") {\r\n      const token = localStorage.getItem('adminToken');\r\n      if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n      }\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(new Error(error?.message ?? String(error)));\r\n  }\r\n);\r\n// --------------------------------------------------\r\n\r\nexport default api;"],"names":[],"mappings":"AAAA,+BAA+B;;;;AAC/B;;AAEA,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IACvB,SAAS;AACX;AAEA,uDAAuD;AACvD,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,OAAO;IACL,sFAAsF;IACtF,wCAAmC;QACjC,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;QAClD;IACF;IACA,OAAO;AACT,GACA,CAAC;IACC,OAAO,QAAQ,MAAM,CAAC,IAAI,MAAM,OAAO,WAAW,OAAO;AAC3D;uCAIa"}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/andre/OneDrive/%C3%81rea%20de%20Trabalho/Nova%20pasta/TCC-1-Avaliacao-de-Sistemas/frontend/src/components/auth/AdminAuthGuard.tsx"],"sourcesContent":["// frontend/src/components/auth/AdminAuthGuard.tsx\r\n'use client';\r\nimport { useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/contexts/AuthContext'; // Ajuste o caminho se o AuthContext estiver em outro lugar\r\n\r\nexport default function AdminAuthGuard({ children }: Readonly<{ children: React.ReactNode }>) {\r\n  const { loggedInAdmin, isLoadingAuth } = useAuth();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    // Não faz nada enquanto o estado de autenticação ainda está carregando do localStorage\r\n    if (isLoadingAuth) {\r\n      return;\r\n    }\r\n\r\n    // Se não estiver logado E o carregamento inicial do auth já terminou, redireciona\r\n    if (!loggedInAdmin && !isLoadingAuth) {\r\n      router.push('/empresas/login'); // Ou para /admin/login se preferir um ponto de entrada único\r\n    }\r\n  }, [loggedInAdmin, isLoadingAuth, router]);\r\n\r\n  // Se ainda estiver carregando o estado de autenticação ou se não estiver logado (e o redirecionamento vai acontecer),\r\n  // pode mostrar um loader ou nada para evitar flash de conteúdo.\r\n  if (isLoadingAuth || !loggedInAdmin) {\r\n    return <div className=\"page-container center-content\"><p>Verificando autorização...</p></div>;\r\n    // Ou return null; para não mostrar nada até o redirecionamento ocorrer.\r\n  }\r\n\r\n  // Se estiver logado, renderiza a página protegida\r\n  return <>{children}</>;\r\n}"],"names":[],"mappings":"AAAA,kDAAkD;;;;;AAElD;AACA;AACA,mOAAkD,2DAA2D;;;AAH7G;;;;AAKe,SAAS,eAAe,EAAE,QAAQ,EAA2C;;IAC1F,MAAM,EAAE,aAAa,EAAE,aAAa,EAAE,GAAG,CAAA,GAAA,kIAAA,CAAA,UAAO,AAAD;IAC/C,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,uFAAuF;YACvF,IAAI,eAAe;gBACjB;YACF;YAEA,kFAAkF;YAClF,IAAI,CAAC,iBAAiB,CAAC,eAAe;gBACpC,OAAO,IAAI,CAAC,oBAAoB,6DAA6D;YAC/F;QACF;mCAAG;QAAC;QAAe;QAAe;KAAO;IAEzC,sHAAsH;IACtH,gEAAgE;IAChE,IAAI,iBAAiB,CAAC,eAAe;QACnC,qBAAO,6LAAC;YAAI,WAAU;sBAAgC,cAAA,6LAAC;0BAAE;;;;;;;;;;;IACzD,wEAAwE;IAC1E;IAEA,kDAAkD;IAClD,qBAAO;kBAAG;;AACZ;GAzBwB;;QACmB,kIAAA,CAAA,UAAO;QACjC,qIAAA,CAAA,YAAS;;;KAFF"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/andre/OneDrive/%C3%81rea%20de%20Trabalho/Nova%20pasta/TCC-1-Avaliacao-de-Sistemas/frontend/src/app/avaliacao/create/page.tsx"],"sourcesContent":["// frontend/src/app/avaliacao/create/page.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect, Suspense } from \"react\";\r\nimport api from \"@/services/api\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport \"../../globals.css\"; // Seu globals.css unificado\r\nimport AdminAuthGuard from \"@/components/auth/AdminAuthGuard\";\r\n\r\ninterface Questionario {\r\n  id: number;\r\n  titulo: string;\r\n}\r\n\r\nfunction CreateAvaliacaoContent() {\r\n  const [semestre, setSemestre] = useState(\"\");\r\n  const [questionarioId, setQuestionarioId] = useState(\"\");\r\n  const [questionarios, setQuestionarios] = useState<Questionario[]>([]);\r\n  const [requerLoginCliente, setRequerLoginCliente] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    setIsLoading(true);\r\n    // A rota /questionarios deve retornar apenas os questionários da empresa do admin logado\r\n    api.get(\"/questionarios\") \r\n      .then(response => {\r\n        setQuestionarios(response.data);\r\n      })\r\n      .catch(err => {\r\n        console.error(\"Erro ao buscar questionários:\", err);\r\n        setError(\"Erro ao buscar questionários para seleção.\");\r\n      }).finally(() => setIsLoading(false));\r\n  }, []);\r\n\r\n  const handleNewAvaliacao = async (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    setError(null);\r\n\r\n    if (!semestre.trim() || !questionarioId) {\r\n      setError(\"Semestre/Contexto e Questionário são obrigatórios!\");\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n\r\n    // O criadorId será adicionado pelo backend usando o token do usuário logado\r\n    const data = {\r\n      semestre: semestre.trim(),\r\n      questionario_id: parseInt(questionarioId),\r\n      requerLoginCliente,\r\n    };\r\n\r\n    try {\r\n      await api.post(\"/avaliacao\", data); // O token já é enviado pelo interceptor\r\n      alert(\"Avaliação cadastrada com sucesso!\");\r\n      router.push(\"/avaliacao\");\r\n    } catch (err: any) {\r\n      console.error(\"Erro ao cadastrar avaliação:\", err.response?.data ?? err.message);\r\n      setError(err.response?.data?.message ?? \"Erro ao cadastrar a avaliação!\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page-container\">\r\n      <div className=\"editor-form-card\" style={{maxWidth: '700px'}}>\r\n        <div className=\"form-header\">\r\n          <h3>Criar Nova Avaliação</h3>\r\n          <Link href=\"/avaliacao\" className=\"btn btn-outline btn-sm\">Voltar</Link>\r\n        </div>\r\n        \r\n        <form onSubmit={handleNewAvaliacao} className=\"display-section\">\r\n          {error && <p style={{ color: 'red', marginBottom: '1rem', textAlign: 'center' }}>{error}</p>}\r\n          \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"semestre\" className=\"form-label\">Semestre / Contexto da Avaliação</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"semestre\"\r\n              value={semestre}\r\n              onChange={(e) => setSemestre(e.target.value)}\r\n              required\r\n              className=\"input-edit-mode\"\r\n              placeholder=\"Ex: 2025/1 - Turma A\"\r\n              disabled={isLoading}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"questionario\" className=\"form-label\">Questionário Vinculado</label>\r\n            <select\r\n              id=\"questionario\"\r\n              value={questionarioId}\r\n              onChange={(e) => setQuestionarioId(e.target.value)}\r\n              required\r\n              className=\"input-edit-mode\" // Reutiliza estilo de select do globals.css\r\n              disabled={isLoading || questionarios.length === 0}\r\n            >\r\n              <option value=\"\">Selecione um questionário...</option>\r\n              {questionarios.map((q) => (\r\n                <option key={q.id} value={q.id}>\r\n                  {q.titulo} (ID: {q.id})\r\n                </option>\r\n              ))}\r\n            </select>\r\n            {questionarios.length === 0 && !isLoading && <p className=\"text-sm text-text-muted mt-1\">Nenhum questionário disponível. Crie um primeiro.</p>}\r\n          </div>\r\n          \r\n          <div className=\"form-group checkbox-label-group\"> {/* Estilo para checkbox */}\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"requerLoginCliente\"\r\n              checked={requerLoginCliente}\r\n              onChange={e => setRequerLoginCliente(e.target.checked)}\r\n              disabled={isLoading}\r\n            />\r\n            <label htmlFor=\"requerLoginCliente\" className=\"form-label\" style={{marginBottom: 0}}>\r\n              Exigir login do cliente para responder?\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"form-actions\"> {/* Estilo para alinhar botões */}\r\n            <button type=\"reset\" onClick={() => {setSemestre(''); setQuestionarioId(''); setRequerLoginCliente(false); setError(null);}} className=\"btn btn-secondary\" disabled={isLoading}>\r\n              Limpar\r\n            </button>\r\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={isLoading}>\r\n              {isLoading ? \"Cadastrando...\" : \"Cadastrar Avaliação\"}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function CreateAvaliacaoPage() {\r\n  return (\r\n    <Suspense fallback={<div className=\"page-container center-content\"><p>Carregando...</p></div>}>\r\n      <AdminAuthGuard>\r\n        <CreateAvaliacaoContent />\r\n      </AdminAuthGuard>\r\n    </Suspense>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 462, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}